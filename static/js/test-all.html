<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modul√°ris UI Architekt√∫ra - Teljes Teszt</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Courier New', monospace;
            background: #000;
            color: #0f0;
            padding: 20px;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        h1 {
            color: #0ff;
            margin-bottom: 20px;
            border-bottom: 2px solid #0f0;
            padding-bottom: 10px;
        }
        
        .test-section {
            background: #111;
            border: 1px solid #0f0;
            padding: 20px;
            margin: 20px 0;
        }
        
        .test-section h2 {
            color: #0ff;
            margin-bottom: 15px;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .test-card {
            background: #1a1a1a;
            border: 1px solid #0f0;
            padding: 15px;
        }
        
        .test-card h3 {
            color: #0ff;
            margin-bottom: 10px;
        }
        
        button {
            background: #0f0;
            color: #000;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }
        
        button:hover {
            background: #0ff;
        }
        
        button:disabled {
            background: #333;
            color: #666;
            cursor: not-allowed;
        }
        
        .output {
            background: #000;
            border: 1px solid #0f0;
            padding: 10px;
            margin-top: 10px;
            min-height: 100px;
            max-height: 300px;
            overflow-y: auto;
            font-size: 12px;
        }
        
        .success { color: #0f0; }
        .error { color: #f00; }
        .info { color: #0ff; }
        .warning { color: #ff0; }
        
        .status {
            display: inline-block;
            padding: 5px 10px;
            margin: 5px;
            border-radius: 3px;
        }
        
        .status-ok { background: #0f0; color: #000; }
        .status-error { background: #f00; color: #fff; }
        .status-warning { background: #ff0; color: #000; }
        
        .component-demo {
            border: 2px solid #0f0;
            padding: 15px;
            margin: 15px 0;
            min-height: 200px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üî¨ Modul√°ris UI Architekt√∫ra - Teljes Teszt</h1>
        
        <!-- Core Modulok Teszt -->
        <div class="test-section">
            <h2>1. Core Modulok</h2>
            <div class="test-grid">
                <div class="test-card">
                    <h3>EventBus</h3>
                    <button onclick="testEventBus()">Teszt</button>
                    <div class="output" id="eventbus-output"></div>
                </div>
                <div class="test-card">
                    <h3>StateManager</h3>
                    <button onclick="testStateManager()">Teszt</button>
                    <div class="output" id="statemanager-output"></div>
                </div>
                <div class="test-card">
                    <h3>APIClient</h3>
                    <button onclick="testAPIClient()">Teszt</button>
                    <div class="output" id="apiclient-output"></div>
                </div>
                <div class="test-card">
                    <h3>ComponentBase</h3>
                    <button onclick="testComponentBase()">Teszt</button>
                    <div class="output" id="componentbase-output"></div>
                </div>
            </div>
        </div>
        
        <!-- Szolg√°ltat√°sok Teszt -->
        <div class="test-section">
            <h2>2. Szolg√°ltat√°sok</h2>
            <div class="test-grid">
                <div class="test-card">
                    <h3>NavigationService</h3>
                    <button onclick="testNavigationService()">Teszt</button>
                    <div class="output" id="navigation-output"></div>
                </div>
                <div class="test-card">
                    <h3>BioCodeService</h3>
                    <button onclick="testBioCodeService()">Teszt</button>
                    <div class="output" id="biocode-output"></div>
                </div>
                <div class="test-card">
                    <h3>EKFService</h3>
                    <button onclick="testEKFService()">Teszt</button>
                    <div class="output" id="ekf-output"></div>
                </div>
                <div class="test-card">
                    <h3>ComparisonService</h3>
                    <button onclick="testComparisonService()">Teszt</button>
                    <div class="output" id="comparison-output"></div>
                </div>
            </div>
        </div>
        
        <!-- Komponensek Teszt -->
        <div class="test-section">
            <h2>3. Komponensek</h2>
            <div class="test-card">
                <h3>ComparisonPanel</h3>
                <div id="comparison-panel-container" class="component-demo"></div>
                <button onclick="testComparisonPanel()">Teszt</button>
            </div>
            <div class="test-card">
                <h3>FileViewer (Bio-code)</h3>
                <div id="fileviewer-biocode-container" class="component-demo"></div>
                <button onclick="testFileViewerBioCode()">Teszt</button>
            </div>
            <div class="test-card">
                <h3>FileViewer (EKF)</h3>
                <div id="fileviewer-ekf-container" class="component-demo"></div>
                <button onclick="testFileViewerEKF()">Teszt</button>
            </div>
        </div>
        
        <!-- √ñsszefoglal√≥ -->
        <div class="test-section">
            <h2>4. √ñsszefoglal√≥</h2>
            <button onclick="runAllTests()" style="background: #0ff; color: #000; padding: 15px 30px; font-size: 16px;">
                üöÄ √ñSSZES TESZT FUTTAT√ÅSA
            </button>
            <div class="output" id="summary-output"></div>
        </div>
    </div>
    
    <script type="module">
        // Importok
        import eventBus from './core/EventBus.js';
        import stateManager from './core/StateManager.js';
        import apiClient from './core/APIClient.js';
        import ComponentBase from './core/ComponentBase.js';
        import navigationService from './services/NavigationService.js';
        import bioCodeService from './services/BioCodeService.js';
        import ekfService from './services/EKFService.js';
        import comparisonService from './services/ComparisonService.js';
        import ComparisonPanel from './components/ComparisonPanel/ComparisonPanel.js';
        import FileViewer from './components/FileViewer/FileViewer.js';
        
        // Glob√°lis el√©r√©s
        window.eventBus = eventBus;
        window.stateManager = stateManager;
        window.apiClient = apiClient;
        window.ComponentBase = ComponentBase;
        window.navigationService = navigationService;
        window.bioCodeService = bioCodeService;
        window.ekfService = ekfService;
        window.comparisonService = comparisonService;
        window.ComparisonPanel = ComparisonPanel;
        window.FileViewer = FileViewer;
        
        // Teszt f√ºggv√©nyek
        window.testEventBus = function() {
            const output = document.getElementById('eventbus-output');
            output.innerHTML = '<span class="info">Tesztel√©s...</span><br>';
            
            let callCount = 0;
            const unsubscribe = eventBus.on('test:eventbus', (data) => {
                callCount++;
                output.innerHTML += `<span class="success">[${callCount}]</span> Event received: ${JSON.stringify(data)}<br>`;
            });
            
            eventBus.emit('test:eventbus', { message: 'Hello' });
            eventBus.emit('test:eventbus', { message: 'World' });
            
            unsubscribe();
            eventBus.emit('test:eventbus', { message: 'Should not appear' });
            
            output.innerHTML += `<br><span class="success">‚úì</span> Total calls: ${callCount} (should be 2)<br>`;
        };
        
        window.testStateManager = function() {
            const output = document.getElementById('statemanager-output');
            output.innerHTML = '<span class="info">Tesztel√©s...</span><br>';
            
            stateManager.setState('test:value', 42);
            const value = stateManager.getState('test:value');
            
            output.innerHTML += `<span class="success">‚úì</span> State set: test:value = 42<br>`;
            output.innerHTML += `<span class="success">‚úì</span> State get: test:value = ${value}<br>`;
            output.innerHTML += `<span class="success">‚úì</span> Test ${value === 42 ? 'PASSED' : 'FAILED'}<br>`;
        };
        
        window.testAPIClient = async function() {
            const output = document.getElementById('apiclient-output');
            output.innerHTML = '<span class="info">Tesztel√©s (backend sz√ºks√©ges)...</span><br>';
            
            try {
                // Pr√≥b√°ljuk meg a /api/v3/status endpoint-ot
                const data = await apiClient.get('/api/v3/status');
                output.innerHTML += `<span class="success">‚úì</span> API request successful<br>`;
                output.innerHTML += `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            } catch (error) {
                output.innerHTML += `<span class="warning">‚ö†</span> API error (expected if backend not running): ${error.message}<br>`;
            }
        };
        
        window.testComponentBase = async function() {
            const output = document.getElementById('componentbase-output');
            output.innerHTML = '<span class="info">Tesztel√©s...</span><br>';
            
            class TestComponent extends ComponentBase {
                async render() {
                    this.container.innerHTML = '<div style="color: #0f0;">Test Component Rendered!</div>';
                }
            }
            
            const container = document.createElement('div');
            const component = new TestComponent(container);
            await component.init();
            
            output.innerHTML += `<span class="success">‚úì</span> Component initialized<br>`;
            output.innerHTML += `<span class="success">‚úì</span> Container content: ${container.innerHTML.length} chars<br>`;
            
            component.destroy();
            output.innerHTML += `<span class="success">‚úì</span> Component destroyed<br>`;
        };
        
        window.testNavigationService = async function() {
            const output = document.getElementById('navigation-output');
            output.innerHTML = '<span class="info">Tesztel√©s (backend sz√ºks√©ges)...</span><br>';
            
            try {
                const data = await navigationService.getOrbitParameters();
                output.innerHTML += `<span class="success">‚úì</span> NavigationService working<br>`;
                output.innerHTML += `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            } catch (error) {
                output.innerHTML += `<span class="warning">‚ö†</span> Error (expected if backend not running): ${error.message}<br>`;
            }
        };
        
        window.testBioCodeService = async function() {
            const output = document.getElementById('biocode-output');
            output.innerHTML = '<span class="info">Tesztel√©s (backend sz√ºks√©ges)...</span><br>';
            
            try {
                const data = await bioCodeService.getLatestFiles();
                output.innerHTML += `<span class="success">‚úì</span> BioCodeService working<br>`;
                output.innerHTML += `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            } catch (error) {
                output.innerHTML += `<span class="warning">‚ö†</span> Error (expected if backend not running): ${error.message}<br>`;
            }
        };
        
        window.testEKFService = async function() {
            const output = document.getElementById('ekf-output');
            output.innerHTML = '<span class="info">Tesztel√©s (backend sz√ºks√©ges)...</span><br>';
            
            try {
                const data = await ekfService.getLatestFiles();
                output.innerHTML += `<span class="success">‚úì</span> EKFService working<br>`;
                output.innerHTML += `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            } catch (error) {
                output.innerHTML += `<span class="warning">‚ö†</span> Error (expected if backend not running): ${error.message}<br>`;
            }
        };
        
        window.testComparisonService = async function() {
            const output = document.getElementById('comparison-output');
            output.innerHTML = '<span class="info">Tesztel√©s (backend sz√ºks√©ges)...</span><br>';
            
            try {
                const data = await comparisonService.getMetrics();
                output.innerHTML += `<span class="success">‚úì</span> ComparisonService working<br>`;
                output.innerHTML += `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            } catch (error) {
                output.innerHTML += `<span class="warning">‚ö†</span> Error (expected if backend not running): ${error.message}<br>`;
            }
        };
        
        window.testComparisonPanel = async function() {
            const container = document.getElementById('comparison-panel-container');
            container.innerHTML = '<span class="info">Inicializ√°l√°s...</span>';
            
            const component = new ComparisonPanel(container);
            await component.init();
            
            // Teszt adatok
            await component.update({
                ekf: {
                    feasibility: 75.5,
                    decision: 'CONTINUE_WITH_MONITORING',
                    confidence: 80.0,
                    anomaly_detected: false,
                    scenes_today: 650,
                    data_loss_today: 50
                },
                metaspace: {
                    feasibility: 92.3,
                    action: 'CONTINUE_NOMINAL',
                    safety_margin: 15,
                    biocode_level3: '0x8F2C_A4E7_B1D9_5C6A'
                }
            });
        };
        
        window.testFileViewerBioCode = async function() {
            const container = document.getElementById('fileviewer-biocode-container');
            container.innerHTML = '<span class="info">Inicializ√°l√°s...</span>';
            
            const component = new FileViewer(container, { fileType: 'biocode' });
            await component.init();
            
            // Teszt adatok
            await component.update({
                level1: {
                    count: 8,
                    biocodes: {
                        'OLI2': '0x0001_8F2C_A4E7_B1D9',
                        'TIRS2': '0x0002_9E3D_B5F8_C2EA'
                    }
                },
                level2: {
                    count: 4,
                    biocodes: {
                        'payload': '0xA7_F4_B2_E8',
                        'power': '0xB8_E5_C3_F9'
                    }
                },
                level3: {
                    mission_day: 150,
                    biocode: '0x8F2C_A4E7_B1D9_5C6A',
                    feasibility: 92.3,
                    action: 'CONTINUE_NOMINAL',
                    safety_margin: 15
                },
                file_paths: {
                    level1: '/path/to/level1.bio',
                    level2: '/path/to/level2.bio',
                    level3: '/path/to/level3.bio'
                }
            });
        };
        
        window.testFileViewerEKF = async function() {
            const container = document.getElementById('fileviewer-ekf-container');
            container.innerHTML = '<span class="info">Inicializ√°l√°s...</span>';
            
            const component = new FileViewer(container, { fileType: 'ekf' });
            await component.init();
            
            // Teszt adatok
            await component.update({
                level1: {
                    count: 4,
                    sensors: {
                        'GPS': {
                            measurement: 705.0,
                            state_estimate: 704.8,
                            covariance: 0.5,
                            confidence: 95.0
                        }
                    }
                },
                level2: {
                    count: 4,
                    subsystems: {
                        'navigation': {
                            health: 85.0,
                            covariance_trace: 12.5
                        }
                    }
                },
                level3: {
                    mission_day: 150,
                    feasibility: 75.5,
                    anomaly_detected: false,
                    detection_latency: 0,
                    confidence: 80.0,
                    decision: 'CONTINUE_WITH_MONITORING',
                    scenes_today: 650,
                    data_loss_today: 50
                },
                file_paths: {
                    level1: '/path/to/level1.ekf',
                    level2: '/path/to/level2.ekf',
                    level3: '/path/to/level3.ekf'
                }
            });
        };
        
        window.runAllTests = async function() {
            const output = document.getElementById('summary-output');
            output.innerHTML = '<span class="info">üöÄ √ñsszes teszt futtat√°sa...</span><br><br>';
            
            const tests = [
                { name: 'EventBus', fn: testEventBus },
                { name: 'StateManager', fn: testStateManager },
                { name: 'APIClient', fn: testAPIClient },
                { name: 'ComponentBase', fn: testComponentBase },
                { name: 'NavigationService', fn: testNavigationService },
                { name: 'BioCodeService', fn: testBioCodeService },
                { name: 'EKFService', fn: testEKFService },
                { name: 'ComparisonService', fn: testComparisonService },
                { name: 'ComparisonPanel', fn: testComparisonPanel },
                { name: 'FileViewer (Bio-code)', fn: testFileViewerBioCode },
                { name: 'FileViewer (EKF)', fn: testFileViewerEKF }
            ];
            
            let passed = 0;
            let failed = 0;
            
            for (const test of tests) {
                try {
                    output.innerHTML += `<span class="info">‚ñ∂</span> Running: ${test.name}...<br>`;
                    await test.fn();
                    output.innerHTML += `<span class="success">‚úì</span> ${test.name}: PASSED<br>`;
                    passed++;
                } catch (error) {
                    output.innerHTML += `<span class="error">‚úó</span> ${test.name}: FAILED - ${error.message}<br>`;
                    failed++;
                }
                await new Promise(resolve => setTimeout(resolve, 500));
            }
            
            output.innerHTML += `<br><span class="info">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</span><br>`;
            output.innerHTML += `<span class="success">‚úì Passed: ${passed}</span><br>`;
            output.innerHTML += `<span class="error">‚úó Failed: ${failed}</span><br>`;
            output.innerHTML += `<span class="info">Total: ${tests.length}</span><br>`;
        };
    </script>
</body>
</html>


