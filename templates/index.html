<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MetaSpace | Mission Control</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>

    <header>
    <div class="brand">
        ❖ METASPACE <span style="opacity:0.5; font-size:0.8em; margin-left:5px;">.BIO V2.0</span>
    </div>

    <div class="status-bar">
        <div class="status-item">SYSTEM: <span style="color:var(--success-green)">ONLINE</span></div>
        <div class="status-item">LOGIC: <span style="color:var(--neon-cyan)">DETERMINISTIC</span></div>
        <div class="status-item">SOLVER: <span style="color:var(--success-green)">VERIFIED (SAFE)</span></div>
    </div>

    <div style="display: flex; gap: 10px; align-items: center;">
        <a href="/v3-sandbox" class="btn-launch" style="border-color: var(--warning-yellow); color: var(--warning-yellow); text-decoration: none; padding: 5px 15px; font-size: 11px;">
            <span style="font-size: 12px; margin-right: 5px;">⚡</span> V3 NEURAL SANDBOX
        </a>
        
        <a href="/docs" class="btn-launch" style="text-decoration: none; padding: 5px 15px; font-size: 11px;">DOCS / METHODOLOGY</a>
    </div>
    </header>

    <div class="mission-control">
        
        <aside class="panel controls-area">
            <div class="panel-title">Flight Configuration</div>
            <div class="control-group">
                <label>INJECTION SCENARIO</label>
                <select id="scenario-select">
                    <option value="solar_panel">Solar Panel Structural Failure</option>
                    <option value="gps_antenna">GPS Spoofing / Signal Loss</option>
                    <option value="battery_failure">Battery Thermal Runaway</option>
                    <option value="imu_drift">IMU Gyro Bias Drift</option>
                    <option value="nominal">Nominal Flight (Control)</option>
                </select>
            </div>
            <div class="control-group">
                <label>MISSION DURATION (DAYS)</label>
                <input type="number" id="duration-input" value="60" min="20" max="365">
            </div>
            <div style="margin-top:auto;">
                <p style="font-size:12px; color:#666; margin-bottom:10px;">*Initiating simulation will trigger the Python physics engine.</p>
                <button id="sim-btn" class="btn-launch" onclick="runSimulation()">EXECUTE SIMULATION</button>
            </div>
        </aside>

        <section class="panel tactical-display">
            <div class="panel-title">Mission Feasibility Analysis (Reliability Curve)</div>
            <div class="chart-wrapper">
                <div class="placeholder-state" id="chart-placeholder" style="color:#555; text-align:center; padding-top:100px;">
                    [ AWAITING TELEMETRY DATA ]<br>
                    <small>Select a scenario to visualize EKF vs MetaSpace performance</small>
                </div>
                <canvas id="feasibilityChart" style="display:none;"></canvas>
            </div>
        </section>

        <aside class="panel telemetry-bay">
            <div class="panel-title">Component Health Matrix (Level 1)</div>
            <div id="component-grid">
                <div style="padding:20px; text-align:center; color:#555;">Waiting for link...</div>
            </div>
        </aside>

        <section class="panel logs-console">
            <div style="border-right: 1px solid rgba(255,255,255,0.1); padding-right:15px;">
                <div class="panel-title">Analysis</div>
                <div id="narrative-box">
                    <span style="color:#555;">> System initialized.</span><br>
                    <span style="color:#555;">> Loaded kinematic model: Landsat-9 (NASA)</span><br>
                    <span style="color:#555;">> Waiting for input...</span>
                </div>
            </div>
            <div>
                <div class="panel-title">Invariant Verification Stream</div>
                <div id="bio-stream" style="height:150px; overflow-y:auto;">
                    <div class="log-entry">[T-0] Z3 Solver Loaded.</div>
                </div>
            </div>
        </section>

    </div>

    <footer class="mission-footer">
        <div style="display: flex; align-items: center; gap: 20px;">
            <span>
                <strong style="color:var(--neon-cyan)">LemonScript Laboratory</strong>
                <span style="opacity:0.5; margin:0 5px;">//</span>
                Citrom Média LTD
            </span>
            
            <span style="opacity:0.3">|</span>
            <a href="https://metaspace.bio" target="_blank">metaspace.bio</a>
            <a href="https://lemonscript.info" target="_blank">lemonscript.info</a>
            
            <span style="opacity:0.3">|</span>
            <a href="https://github.com/lemonscripter/MetaSpace-Drone-Shield" target="_blank" style="display: flex; align-items:center; gap:5px;">
                <svg height="14" width="14" viewBox="0 0 16 16" fill="currentColor" style="opacity:0.8"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg>
                GitHub Repository
            </a>
        </div>

        <div>
            <span class="footer-status-dot"></span>
            SECURE CHANNEL: 
            <a href="mailto:hello&#64;lemonscript&#46;info">
                hello&#64;lemonscript&#46;info
            </a>
        </div>
    </footer>

    <div id="intro-modal" class="modal-overlay">
        <div class="modal-content">
            <span class="modal-close" style="float:right; cursor:pointer; color:var(--neon-cyan); font-size:24px;" onclick="document.getElementById('intro-modal').style.display='none'">&times;</span>
            <h2 style="color:#fff; margin-top:0; font-family:'Orbitron'">MetaSpace Validation Environment</h2>
            <p style="color:#aaa;">Ez az eszköz a MetaSpace determinisztikus FDIR algoritmus validációs környezete (TRL-4).</p>
            <div style="border-left: 3px solid var(--neon-cyan); padding-left:15px; margin:20px 0; color:#ddd;">
                <p><strong>Cél:</strong> Demonstrálni a különbséget a sztochasztikus (EKF) és az invariáns-alapú (MetaSpace) hibakezelés között.</p>
                <p><strong>Hogyan használd:</strong> Válassz egy hibaforrást a bal oldali panelen, és figyeld meg a "Component Health Matrix" szelektív izolációs képességét.</p>
            </div>
            <div style="margin-bottom: 20px;">
                <button class="btn-launch" style="width:auto; padding:10px 30px; display:inline-block; margin-right:10px;" onclick="closeModalAndRun()">Load Solar Panel Demo</button>
                <button class="btn-launch" style="width:auto; padding:10px 30px; border-color:#555; color:#aaa; display:inline-block;" onclick="document.getElementById('intro-modal').style.display='none'">Manual Config</button>
            </div>
            <div class="sys-req">⚠ OPTIMAL DISPLAY: 1920x1080 (DESKTOP) | MINIMUM VIEWPORT WIDTH: 1280px</div>
        </div>
    </div>

    <script src="/static/js/main.js"></script>
    <script src="/static/js/interpretation.js"></script>
    <script>
        function closeModalAndRun() {
            document.getElementById('intro-modal').style.display='none';
            document.getElementById('scenario-select').value = 'solar_panel';
            runSimulation();
        }
    </script>
</body>
</html>