<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MetaSpace | Navigation Plan Execution</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        /* Navigation Plan Oldal Stílusok */
        body {
            margin: 0;
            padding: 0;
            background: var(--bg-deep);
            color: var(--text-main);
            font-family: var(--hud-font);
            overflow: hidden;
        }
        
        .navigation-plan-header {
            background: rgba(0, 5, 10, 0.9);
            border-bottom: 1px solid var(--neon-cyan);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }
        
        .header-title {
            font-size: 18px;
            font-weight: bold;
            color: var(--neon-cyan);
        }
        
        .header-info {
            display: flex;
            gap: 20px;
            font-size: 12px;
        }
        
        .header-info-item {
            color: var(--text-secondary);
        }
        
        .header-info-value {
            color: var(--success-green);
            font-weight: bold;
        }
        
        .navigation-plan-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 20px;
            height: calc(100vh - 70px);
            overflow-y: auto;
            overflow-x: hidden;
        }
        
        /* Layout scrollbar */
        @supports (scrollbar-width: thin) {
            .navigation-plan-layout {
                scrollbar-width: thin;
                scrollbar-color: rgba(0, 243, 255, 0.5) rgba(0, 0, 0, 0.3);
            }
        }
        
        .navigation-plan-layout::-webkit-scrollbar {
            width: 10px;
        }
        
        .navigation-plan-layout::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
        }
        
        .navigation-plan-layout::-webkit-scrollbar-thumb {
            background: rgba(0, 243, 255, 0.5);
            border-radius: 5px;
        }
        
        .left-panel, .right-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow-y: auto;
            overflow-x: hidden;
            min-height: 0; /* Fontos: flexbox scrollhoz */
            align-items: stretch;
        }
        
        .panel-section {
            background: rgba(0, 5, 10, 0.6);
            border: 1px solid rgba(0, 243, 255, 0.15);
            border-radius: 4px;
            padding: 15px;
            overflow: visible;
            display: flex;
            flex-direction: column;
            min-height: 250px;
            max-height: none;
        }
        
        .panel-title {
            font-size: 14px;
            font-weight: bold;
            color: var(--neon-cyan);
            margin-bottom: 15px;
            border-bottom: 1px solid rgba(0, 243, 255, 0.2);
            padding-bottom: 10px;
        }
        
        .panel-content {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            min-height: 150px;
            position: relative;
        }
        
        /* Üres állapot stílus */
        .file-viewer-empty {
            padding: 30px;
            text-align: center;
            color: rgba(0, 243, 255, 0.6);
            font-size: 14px;
        }
        
        .file-viewer-empty p {
            margin: 10px 0;
        }
        
        /* Scrollbar styling */
        /* Scrollbar styling - csak akkor, ha támogatott */
        @supports (scrollbar-width: thin) {
            .panel-content {
                scrollbar-width: thin;
                scrollbar-color: rgba(0, 243, 255, 0.5) rgba(0, 0, 0, 0.3);
            }
        }
        
        /* Webkit scrollbar (Chrome, Safari) */
        .panel-content::-webkit-scrollbar {
            width: 8px;
        }
        
        .panel-content::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
        }
        
        .panel-content::-webkit-scrollbar-thumb {
            background: rgba(0, 243, 255, 0.5);
            border-radius: 4px;
        }
        
        .panel-content::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 243, 255, 0.8);
        }
        
        /* Orbit Visualization */
        #orbit-visualization {
            width: 100%;
            height: 100%;
            min-height: 400px;
        }
        
        /* Task Timeline */
        .task-timeline {
            height: 200px;
            position: relative;
        }
        
        .timeline-track {
            stroke: rgba(0, 243, 255, 0.3);
            stroke-width: 2;
        }
        
        .timeline-task {
            fill: var(--neon-cyan);
            opacity: 0.7;
            cursor: pointer;
        }
        
        .timeline-task:hover {
            opacity: 1;
        }
        
        /* Comparison Panel */
        .comparison-panel {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(0, 243, 255, 0.2);
            border-radius: 4px;
            padding: 15px;
            min-height: 300px;
        }
        
        .comparison-header {
            margin-bottom: 15px;
            border-bottom: 1px solid rgba(0, 243, 255, 0.2);
            padding-bottom: 10px;
        }
        
        .comparison-header h3 {
            margin: 0;
            font-size: 14px;
            color: var(--neon-cyan);
        }
        
        .comparison-timestamp {
            font-size: 11px;
            color: var(--text-secondary);
            margin-top: 5px;
        }
        
        .comparison-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .comparison-column {
            padding: 15px;
            border: 1px solid rgba(0, 243, 255, 0.2);
            border-radius: 4px;
            min-height: 200px;
        }
        
        .column-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(0, 243, 255, 0.1);
        }
        
        .column-header h4 {
            margin: 0;
            font-size: 16px;
            color: var(--neon-cyan);
        }
        
        .column-status {
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: bold;
        }
        
        .status-nominal {
            background: rgba(0, 255, 136, 0.2);
            color: var(--success-green);
        }
        
        .status-warning {
            background: rgba(255, 215, 0, 0.2);
            color: var(--warning-yellow);
        }
        
        .status-critical {
            background: rgba(255, 42, 42, 0.2);
            color: #ff2a2a;
        }
        
        .comparison-metrics {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .comparison-difference {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 3px;
            border: 1px solid rgba(0, 243, 255, 0.2);
        }
        
        .difference-label {
            color: var(--text-secondary);
            font-size: 12px;
        }
        
        .difference-value {
            color: var(--success-green);
            font-weight: bold;
            font-size: 16px;
        }
        
        .difference-value.positive {
            color: var(--success-green);
        }
        
        .difference-value.negative {
            color: #ff2a2a;
        }
        
        .difference-value.neutral {
            color: var(--text-secondary);
        }
        
        .ekf-column {
            border-color: rgba(255, 107, 53, 0.5);
        }
        
        .metaspace-column {
            border-color: rgba(0, 243, 255, 0.5);
        }
        
        .metric {
            margin: 8px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 3px;
        }
        
        .metric label {
            color: var(--text-secondary);
            font-size: 12px;
            flex: 1;
        }
        
        .metric-value {
            color: var(--success-green);
            font-weight: bold;
            font-size: 13px;
            text-align: right;
            flex: 1;
        }
        
        .metric-value.bio-code {
            font-family: 'Courier New', monospace;
            font-size: 11px;
            word-break: break-all;
        }
        
        .metric-value.large {
            font-size: 16px;
        }
        
        /* Biztosítjuk, hogy a komponensek láthatóak legyenek */
        #comparison-panel-container,
        #biocode-viewer-container,
        #ekf-viewer-container {
            min-height: 200px;
            width: 100%;
        }
        
        /* Üres állapot stílus javítása */
        .file-viewer-empty {
            padding: 30px;
            text-align: center;
            color: rgba(0, 243, 255, 0.8);
            font-size: 14px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            border: 1px dashed rgba(0, 243, 255, 0.3);
        }
        
        .file-viewer-empty p {
            margin: 10px 0;
        }
        
        /* Loading állapot */
        .loading-state {
            padding: 20px;
            text-align: center;
            color: rgba(0, 243, 255, 0.6);
            font-size: 12px;
        }
        
        /* Biztosítjuk, hogy a gombok láthatóak legyenek */
        .control-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .control-button {
            background: var(--neon-cyan);
            color: #000;
            border: none;
            padding: 12px 24px;
            cursor: pointer;
            border-radius: 3px;
            font-weight: bold;
            font-size: 12px;
            min-width: 120px;
        }
        
        .control-button:hover {
            background: var(--success-green);
        }
        
        .control-button.stop {
            background: rgba(255, 42, 42, 0.8);
            color: #fff;
        }
        
        .control-button.stop:hover {
            background: rgba(255, 42, 42, 1);
        }
        
        .control-button:disabled {
            background: rgba(100, 100, 100, 0.3);
            color: rgba(255, 255, 255, 0.3);
            cursor: not-allowed;
        }
        
        /* File Viewer */
        .file-viewer {
            min-height: 250px;
        }
        
        .file-viewer-header {
            margin-bottom: 15px;
            border-bottom: 1px solid rgba(0, 243, 255, 0.2);
            padding-bottom: 10px;
        }
        
        .file-viewer-header h3 {
            margin: 0 0 10px 0;
            font-size: 14px;
            color: var(--neon-cyan);
        }
        
        .file-viewer-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .file-viewer-content {
            min-height: 200px;
        }
        
        .file-viewer-level {
            padding: 10px;
        }
        
        .file-viewer-info {
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 3px;
            font-size: 11px;
        }
        
        .file-path {
            color: var(--text-secondary);
            margin-bottom: 5px;
        }
        
        .file-count, .file-mission-day {
            color: var(--neon-cyan);
        }
        
        .file-viewer-data {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .biocode-entry, .ekf-entry {
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 3px;
            border: 1px solid rgba(0, 243, 255, 0.1);
        }
        
        .biocode-node, .biocode-module, .ekf-sensor, .ekf-subsystem {
            font-weight: bold;
            color: var(--neon-cyan);
            margin-bottom: 5px;
        }
        
        .biocode-value, .ekf-value {
            font-family: 'Courier New', monospace;
            color: var(--success-green);
            font-size: 12px;
            word-break: break-all;
        }
        
        .ekf-details {
            margin-top: 8px;
            font-size: 11px;
            color: var(--text-secondary);
        }
        
        .ekf-details div {
            margin: 3px 0;
        }
        
        .biocode-label, .ekf-label {
            color: var(--text-secondary);
            font-size: 12px;
            margin-bottom: 5px;
        }
        
        .file-viewer-validation {
            margin-top: 15px;
            padding: 10px;
            border-radius: 3px;
            font-size: 12px;
        }
        
        .validation-passed {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            color: var(--success-green);
        }
        
        .validation-failed {
            background: rgba(255, 42, 42, 0.1);
            border: 1px solid rgba(255, 42, 42, 0.3);
            color: #ff2a2a;
        }
        
        .validation-status {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .validation-details {
            font-size: 11px;
            margin-top: 5px;
        }
        
        .tab-button {
            background: rgba(0, 243, 255, 0.1);
            border: 1px solid rgba(0, 243, 255, 0.3);
            color: var(--text-main);
            padding: 8px 15px;
            cursor: pointer;
            border-radius: 3px;
            font-size: 12px;
        }
        
        .tab-button:hover {
            background: rgba(0, 243, 255, 0.2);
        }
        
        .tab-button.active {
            background: var(--neon-cyan);
            color: #000;
            font-weight: bold;
        }
        
        /* Control Buttons */
        .control-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .control-button {
            background: var(--neon-cyan);
            color: #000;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 3px;
            font-weight: bold;
            font-size: 12px;
        }
        
        .control-button:hover {
            background: var(--success-green);
        }
        
        .control-button.stop {
            background: rgba(255, 42, 42, 0.8);
            color: #fff;
        }
        
        .control-button.stop:hover {
            background: rgba(255, 42, 42, 1);
        }
    </style>
</head>
<body>
    <div class="navigation-plan-header">
        <div class="header-title">
            ❖ NAVIGATION PLAN EXECUTION
        </div>
        <div class="header-info">
            <div class="header-info-item">
                Mission Day: <span class="header-info-value" id="mission-day">0</span>
            </div>
            <div class="header-info-item">
                Status: <span class="header-info-value" id="simulation-status">STANDBY</span>
            </div>
            <div class="header-info-item">
                Time: <span class="header-info-value" id="current-time">00:00:00</span>
            </div>
        </div>
    </div>
    
    <div class="navigation-plan-layout">
        <!-- BAL OLDAL: Orbit Visualization -->
        <div class="left-panel">
            <div class="panel-section">
                <div class="panel-title">Orbit Path & Position</div>
                <div class="panel-content">
                    <svg id="orbit-visualization"></svg>
                </div>
            </div>
            
            <div class="panel-section">
                <div class="panel-title">Task Timeline</div>
                <div class="panel-content">
                    <div class="task-timeline" id="task-timeline"></div>
                </div>
            </div>
            
            <div class="panel-section">
                <div class="panel-title">Orbit Parameters</div>
                <div class="panel-content" id="orbit-parameters">
                    <div class="metric">
                        <label>Altitude:</label>
                        <div class="metric-value" id="altitude">705 km</div>
                    </div>
                    <div class="metric">
                        <label>Orbital Period:</label>
                        <div class="metric-value" id="period">99 min</div>
                    </div>
                    <div class="metric">
                        <label>Inclination:</label>
                        <div class="metric-value" id="inclination">98.2°</div>
                    </div>
                    <div class="metric">
                        <label>Current Orbit:</label>
                        <div class="metric-value" id="current-orbit">-</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- JOBB OLDAL: Satellite Control -->
        <div class="right-panel">
            <div class="panel-section">
                <div class="panel-title">EKF vs MetaSpace Comparison</div>
                <div class="panel-content" id="comparison-panel-container"></div>
            </div>
            
            <div class="panel-section">
                <div class="panel-title">Bio-Code Files (MetaSpace)</div>
                <div class="panel-content" id="biocode-viewer-container"></div>
            </div>
            
            <div class="panel-section">
                <div class="panel-title">EKF Files</div>
                <div class="panel-content" id="ekf-viewer-container"></div>
            </div>
            
            <div class="panel-section">
                <div class="panel-title">Control</div>
                <div class="panel-content">
                    <div class="control-buttons">
                        <button class="control-button" id="start-simulation">▶ Start Simulation</button>
                        <button class="control-button stop" id="stop-simulation" style="display: none;">⏹ Stop</button>
                        <button class="control-button" id="reset-simulation">↻ Reset</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Moduláris JS modulok -->
    <script type="module" src="/static/js/pages/navigation-plan-page.js"></script>
</body>
</html>

